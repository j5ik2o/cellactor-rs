# 機能仕様: [FEATURE NAME]

**ブランチ**: `[###-feature-name]`  
**作成日**: [DATE]  
**ステータス**: Draft  
**入力**: ユーザ要望: "$ARGUMENTS"

> 原則3遵守のため、protoactor-go / Apache Pekko の該当箇所調査と Rust への落とし込み方針を各節で明示すること。

## ユーザーストーリーとテスト（必須）

ユーザーストーリーは優先度付きの独立したユーザージャーニーとして記述し、単体で価値を届けられることを保証する。  
各ストーリーは以下を必ず含めること:
- 優先度（P1, P2, P3, ...）
- 独立したテスト手段
- 成功条件を満たす受け入れシナリオ

### ユーザーストーリー1 - [短いタイトル]（優先度: P1）

[ストーリー内容を平易に記述]

**優先度の理由**: [なぜP1なのかを説明]  
**独立テスト**: [具体的なテスト方法]  

**受け入れシナリオ**:

1. **前提** [初期状態]、**操作** [アクション]、**結果** [期待される状態]
2. **前提** [初期状態]、**操作** [アクション]、**結果** [期待される状態]

---

### ユーザーストーリー2 - [短いタイトル]（優先度: P2）

[ストーリー内容]

**優先度の理由**: [...]  
**独立テスト**: [...]  

**受け入れシナリオ**:

1. **前提** [...], **操作** [...], **結果** [...]

---

### ユーザーストーリー3 - [短いタイトル]（優先度: P3）

[ストーリー内容]

**優先度の理由**: [...]  
**独立テスト**: [...]  

**受け入れシナリオ**:

1. **前提** [...], **操作** [...], **結果** [...]

---

必要に応じて更なるユーザーストーリーを追加する。

### 境界条件・例外

- [境界条件] の場合はどうなるか
- [エラーシナリオ] の扱いはどうするか

## 要件（必須）

機能要件はテスト可能な文として記述し、`no_std` 制約や破壊的変更の扱いを明確にする。  
不明点は `NEEDS CLARIFICATION` を付与して記録する。

### 機能要件

- **FR-001**: システムは [具体的な機能] を提供しなければならない。
- **FR-002**: システムは [検証ルール] を満たさなければならない。
- **FR-003**: ユーザーは [主要な操作] を実行できなければならない。
- **FR-004**: システムは [データ要件] を維持しなければならない。
- **FR-005**: コア機能は `#![no_std]` 環境で動作し、`std` 依存は `cfg(test)` または別クレートに限定しなければならない。共有参照・ロック機構は必ず `modules/utils-core` の `Shared`/`ArcShared` および `AsyncMutexLike`/`SyncMutexLike` 抽象を用い、`alloc::sync::Arc` やプラットフォーム固有 Mutex への直接依存を禁止する。`tokio` や `embassy` などのランタイム依存は `modules/*-std` または `modules/*-embedded` に隔離し、`modules/*-core` では利用しない。
- **FR-006**: [NEEDS CLARIFICATION: 具体的な認証方式など未確定事項]
- **FR-007**: 新規コードは対象ドメインの既存モジュールを調査し、支配的な設計パターン（抽象化、トレイト利用、命名）と整合しなければならない。意図的に乖離する場合は spec/plan/tasks に根拠と参照ファイルを記録する。  
- **FR-008**: 公開 API の命名には `Typed` / `Untyped` 等の歴史的命名を含めず、静的型付けを前提とした分かりやすい名称を採用する。循環参照が発生する設計を避け、必要な場合は関数型抽象などで依存関係を解消する方針を仕様に明記する。  

### 重要エンティティ（データを扱う場合）

- **[エンティティ1]**: [役割と主要属性]
- **[エンティティ2]**: [他エンティティとの関係]

## 成功指標（必須）

技術に依存しない測定可能な指標を設定する。

### 定量的成果

- **SC-001**: [例: アクター起動が 50ms 以内で完了する]
- **SC-002**: [例: 1000 メッセージ/秒を処理してもバックログが蓄積しない]
- **SC-003**: [例: プライマリユースケースの初回成功率 90% 以上]
- **SC-004**: [例: 関連サポート問い合わせを 50% 削減する]
